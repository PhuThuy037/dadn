{"mode":"block","xmlText":"<xml xmlns=\"https://developers.google.com/blockly/xml\"><variables><variable id=\"NdQ*4O99BO|~)p2Qwigo\">Cycle_DHT20</variable><variable id=\"Q=mKuG.+Um.g|hp`.cCn\">CL-RELAY</variable><variable id=\"-x)g*+,r[m1Qvfbbc+$$\">thông tin</variable></variables><block type=\"procedures_defnoreturn\" id=\"5-hcMNhX-Z8C[@sGDyT~\" x=\"138\" y=\"-213\"><field name=\"NAME\">DHT20</field><comment pinned=\"false\" h=\"80\" w=\"160\">Mô tả hàm này...</comment><statement name=\"STACK\"><block type=\"math_change\" id=\"LBW4qrSQ5Swy6$F)V)dp\"><field name=\"VAR\" id=\"NdQ*4O99BO|~)p2Qwigo\">Cycle_DHT20</field><value name=\"DELTA\"><shadow type=\"math_number\" id=\"ra_E3OXyTF#PON:X/x74\"><field name=\"NUM\">1</field></shadow><block type=\"math_number\" id=\"fhi)v$$2~A08iJ=KJu*y\"><field name=\"NUM\">1</field></block></value><next><block type=\"controls_if\" id=\"ys,O!NQl{%S1/^|.?7XL\"><value name=\"IF0\"><block type=\"logic_compare\" id=\"{b99RN]Dd0N7j:$$`R6H\"><field name=\"OP\">GTE</field><value name=\"A\"><block type=\"variables_get\" id=\"LnIiapDO/N#-N6Rl`Gc*\"><field name=\"VAR\" id=\"NdQ*4O99BO|~)p2Qwigo\">Cycle_DHT20</field></block></value><value name=\"B\"><block type=\"math_number\" id=\"j{n)PX#$:]vi[KcT]]6v\"><field name=\"NUM\">5</field></block></value></block></value><statement name=\"DO0\"><block type=\"variables_set\" id=\"R:jihfK1)Px9|mFOz,cp\"><field name=\"VAR\" id=\"NdQ*4O99BO|~)p2Qwigo\">Cycle_DHT20</field><value name=\"VALUE\"><block type=\"math_number\" id=\"Od}nL0z;ir,xhK)EkJ@u\"><field name=\"NUM\">0</field></block></value><next><block type=\"aiot_dht_measure\" id=\"a(,f}zf=w(M##s~(;Ved\"><next><block type=\"aiot_lcd1602_display\" id=\"{DW,{1J}M)*za7@@NK)$\"><value name=\"string\"><shadow type=\"text\" id=\"32ICoASA,[B?oz6mPva4\"><field name=\"TEXT\">Hello</field></shadow><block type=\"text_join\" id=\"m{]Fip8^wOK@TLnB`1}}\"><mutation items=\"2\"></mutation><value name=\"ADD0\"><block type=\"text\" id=\"a$9GxXg^9L@#Ecorq_$)\"><field name=\"TEXT\">TEMP : </field></block></value><value name=\"ADD1\"><block type=\"aiot_dht_read\" id=\"F_#E`c6eMC./RX#wnG.g\"><field name=\"DATA\">TEMP</field></block></value></block></value><value name=\"X\"><shadow type=\"math_number\" id=\"}L`%?Yx;EH*FsWo,:RR*\"><field name=\"NUM\">0</field></shadow></value><value name=\"Y\"><shadow type=\"math_number\" id=\"bt)zVU5uO4VDI+L0tAiY\"><field name=\"NUM\">0</field></shadow></value><next><block type=\"aiot_lcd1602_display\" id=\"BQnFmaj3Iu1PtYW,PS@O\"><value name=\"string\"><shadow type=\"text\" id=\"32ICoASA,[B?oz6mPva4\"><field name=\"TEXT\">Hello</field></shadow><block type=\"text_join\" id=\"cN{p91_wAxm6b|SKq~`/\"><mutation items=\"2\"></mutation><value name=\"ADD0\"><block type=\"text\" id=\"rBw5T@zGu(Uuw0;dQ2;s\"><field name=\"TEXT\">HUMA: </field></block></value><value name=\"ADD1\"><block type=\"aiot_dht_read\" id=\"qDtje{uK7ceKAlx(x0NG\"><field name=\"DATA\">HUMID</field></block></value></block></value><value name=\"X\"><shadow type=\"math_number\" id=\"?=hOC]%Ma=2;j/3#QW20\"><field name=\"NUM\">0</field></shadow></value><value name=\"Y\"><shadow type=\"math_number\" id=\"G1j!bGVD7V@pO#s;U8w.\"><field name=\"NUM\">0</field></shadow></value><next><block type=\"yolobit_mqtt_publish\" id=\"dlFvUReB0FCAn_~G_l60\"><value name=\"MESSAGE\"><shadow type=\"text\" id=\"D7y:@WS*~OP4,^F:@-$I\"><field name=\"TEXT\">Hello</field></shadow><block type=\"aiot_dht_read\" id=\"k%DbH_xK1gUN}5hB@V0@\"><field name=\"DATA\">TEMP</field></block></value><value name=\"TOPIC\"><shadow type=\"text\" id=\"vL9o?ZnWStP#SEaa3$L;\"><field name=\"TEXT\">bbc-temp</field></shadow></value><next><block type=\"yolobit_mqtt_publish\" id=\"FW4PqxDVXqQ$@qQ)u(HR\"><value name=\"MESSAGE\"><shadow type=\"text\" id=\"P{!1d|502X-(JWK[{x)b\"><field name=\"TEXT\">Hello</field></shadow><block type=\"aiot_dht_read\" id=\"LhJjoIda%HR@#,m:#?Xl\"><field name=\"DATA\">HUMID</field></block></value><value name=\"TOPIC\"><shadow type=\"text\" id=\"D|*bOEC_;M~q,?-MPbal\"><field name=\"TEXT\">huma</field></shadow></value></block></next></block></next></block></next></block></next></block></next></block></statement></block></next></block></statement></block><block type=\"yolobit_basic_forever\" id=\"w5Bl*-!,Ihc8X2tI)wP*\" x=\"-1063\" y=\"-88\"><statement name=\"ONSTART\"><block type=\"yolobit_mqtt_connect_wifi\" id=\"hGF(PjH,JcPv|6p}ynXI\"><value name=\"WIFI\"><shadow type=\"text\" id=\"h;vy5[NCwZsDf_.3MJeL\"><field name=\"TEXT\">Tho1</field></shadow></value><value name=\"PASSWORD\"><shadow type=\"text\" id=\"5`qJ;_O`E)mFv@bu*;a!\"><field name=\"TEXT\">thobec113</field></shadow></value><next><block type=\"variables_set\" id=\"DyOO[N.4ae},x^%6;;k=\"><field name=\"VAR\" id=\"NdQ*4O99BO|~)p2Qwigo\">Cycle_DHT20</field><value name=\"VALUE\"><block type=\"math_number\" id=\"JgBDu84kUIP.l.3[)4%=\"><field name=\"NUM\">0</field></block></value><next><block type=\"variables_set\" id=\"7pg%pw7FU2oAhK%.,{mn\"><field name=\"VAR\" id=\"Q=mKuG.+Um.g|hp`.cCn\">CL-RELAY</field><value name=\"VALUE\"><block type=\"math_number\" id=\"Z|e,N.e/,Q#ayv:TL-:t\"><field name=\"NUM\">0</field></block></value><next><block type=\"set_time\" id=\".(5}2YP,(D-Cp9(cp%dm\"><field name=\"GMT\">+7</field><next><block type=\"yolobit_mqtt_connect_default_servers\" id=\"N!t)vCjAJrDjsmeZ#*y2\"><field name=\"SERVER\">io.adafruit.com</field><value name=\"USERNAME\"><shadow type=\"text\" id=\"*]u2wHN%F/`b(e.LFh[@\"><field name=\"TEXT\">ThuyXiba</field></shadow></value><value name=\"KEY\"><shadow type=\"text\" id=\"hb[9N?H6gL!qk?{J[$0|\"><field name=\"TEXT\">aio_trkG309x5yjE2jyhWP7UR53tYAqI</field></shadow></value><next><block type=\"yolobit_basic_show_image\" id=\"Gvp%ENs!8yN{8nohIOx{\"><value name=\"image\"><block type=\"yolobit_basic_image_builtins\" id=\"6FJCMyq46OrE([`?_xhr\"><field name=\"image\">HEART</field></block></value><next><block type=\"yolobit_mqtt_on_receive_message\" id=\"PwZ93p1mHMwG/z$YIHEx\"><field name=\"message\" id=\"-x)g*+,r[m1Qvfbbc+$$\">thông tin</field><value name=\"TOPIC\"><shadow type=\"text\" id=\"Rs7;_]mt$Rk[Vx0*d`k;\"><field name=\"TEXT\">bbc-led</field></shadow></value><statement name=\"ACTION\"><block type=\"controls_if\" id=\"!!S+%fvn.fnFm`24+Uc!\"><mutation else=\"1\"></mutation><value name=\"IF0\"><block type=\"logic_compare\" id=\"eHh^rTHWBCS|8LqxP8bc\"><field name=\"OP\">EQ</field><value name=\"A\"><block type=\"variables_get\" id=\"%q`xfvD91Xbmc`]{[%aI\"><field name=\"VAR\" id=\"-x)g*+,r[m1Qvfbbc+$$\">thông tin</field></block></value><value name=\"B\"><block type=\"text\" id=\"k3acH:lK4]/m2^;-mA)Z\"><field name=\"TEXT\">1</field></block></value></block></value><statement name=\"DO0\"><block type=\"aiot_led_tiny_set_all\" id=\"fM6CeT{lG()jEaIP*K;L\"><field name=\"port\">pin14</field><field name=\"option\">0</field><value name=\"COLOR\"><shadow type=\"colour_picker\" id=\"tQhx^`v(zU8zr$MPWuD3\"><field name=\"COLOUR\">#ff0000</field></shadow></value></block></statement><statement name=\"ELSE\"><block type=\"aiot_led_tiny_set_all\" id=\",[fbp{-EP4Ve6Y2QquS(\"><field name=\"port\">pin14</field><field name=\"option\">0</field><value name=\"COLOR\"><shadow type=\"colour_picker\" id=\"}[/(-^A9J]7fRHXW34jb\"><field name=\"COLOUR\">#000000</field></shadow></value></block></statement></block></statement><next><block type=\"yolobit_mqtt_on_receive_message\" id=\"2*ShsV5_fA[.3VC#r9K:\"><field name=\"message\" id=\"-x)g*+,r[m1Qvfbbc+$$\">thông tin</field><value name=\"TOPIC\"><shadow type=\"text\" id=\"HWip;(k9/wGKlg.7qm/y\"><field name=\"TEXT\">bbc-led</field></shadow></value><statement name=\"ACTION\"><block type=\"controls_if\" id=\"%D6g5(p{ou8gtvL{zE(j\"><mutation else=\"1\"></mutation><value name=\"IF0\"><block type=\"logic_compare\" id=\"~2|`O2._F|mu{Bje:!pb\"><field name=\"OP\">EQ</field><value name=\"A\"><block type=\"variables_get\" id=\")bz;_NCIhxU}WI:es]hq\"><field name=\"VAR\" id=\"-x)g*+,r[m1Qvfbbc+$$\">thông tin</field></block></value><value name=\"B\"><block type=\"text\" id=\"u|n*K{ljDn{JWn)RKX9D\"><field name=\"TEXT\">1</field></block></value></block></value><statement name=\"DO0\"><block type=\"yolobit_pin_write_digital\" id=\"?RkFsji,Kv4plnJsj%I!\"><field name=\"pin\">3</field><value name=\"output\"><shadow type=\"math_number\" id=\"IZ:H;rSQK2GV;G:pX3et\"><field name=\"NUM\">0</field></shadow><block type=\"yolobit_pin_onoff_value\" id=\"$}mMaINz.=K.}@6#yCh;\"><field name=\"value\">1</field></block></value></block></statement><statement name=\"ELSE\"><block type=\"yolobit_pin_write_digital\" id=\".;R0*;O$1sqvks~*;jD%\"><field name=\"pin\">3</field><value name=\"output\"><shadow type=\"math_number\" id=\"IZ:H;rSQK2GV;G:pX3et\"><field name=\"NUM\">0</field></shadow><block type=\"yolobit_pin_onoff_value\" id=\"zWpV!}vOc:E}N^Axum1Q\"><field name=\"value\">0</field></block></value></block></statement></block></statement><next><block type=\"yolobit_mqtt_on_receive_message\" id=\"(O|HYf$6${TzGg4_FeVQ\"><field name=\"message\" id=\"-x)g*+,r[m1Qvfbbc+$$\">thông tin</field><value name=\"TOPIC\"><shadow type=\"text\" id=\"J+RYeoB:HRHi*p,%1pDw\"><field name=\"TEXT\">bbc-quat</field></shadow></value><statement name=\"ACTION\"><block type=\"aiot_minifan\" id=\"^QuU|YopYlI%4w!d*av-\"><field name=\"NAME\">pin10</field><value name=\"percent\"><shadow type=\"math_number\" id=\"eg@=:Lpy)$,4)g@E6W!z\"><field name=\"NUM\">70</field></shadow><block type=\"math_tonum\" id=\"sA!5w4aru)MkH[QWzTaD\"><value name=\"A\"><block type=\"variables_get\" id=\"B8*%/9#3!Js{Q@Qj9Ga*\"><field name=\"VAR\" id=\"-x)g*+,r[m1Qvfbbc+$$\">thông tin</field></block></value></block></value></block></statement></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></next></block></statement><statement name=\"FOREVER\"><block type=\"yolobit_mqtt_check_message\" id=\"qU:B,=H8)P55V;b5+1os\"><next><block type=\"procedures_callnoreturn\" id=\"e`t`Dt-.OwBxgQBTn%Qv\"><mutation name=\"DHT20\"></mutation><next><block type=\"procedures_callnoreturn\" id=\"_NyD)2:gc$`B;D2F/qM`\"><mutation name=\"on_time\"></mutation><next><block type=\"yolobit_basic_sleep\" id=\"o{nRv;OD#8Dta6Xehit}\"><value name=\"duration\"><shadow type=\"math_number\" id=\"Q4/x(N%_5nLCkPnJlLho\"><field name=\"NUM\">1000</field></shadow></value></block></next></block></next></block></next></block></statement></block><block type=\"procedures_defnoreturn\" id=\"))jujjdWVXX1zg:KpRBh\" x=\"88\" y=\"338\"><field name=\"NAME\">on_time</field><comment pinned=\"false\" h=\"80\" w=\"160\">Mô tả hàm này...</comment><statement name=\"STACK\"><block type=\"variables_set\" id=\"A`oS}W^duHkrP{|s9Kt`\"><field name=\"VAR\" id=\"Q=mKuG.+Um.g|hp`.cCn\">CL-RELAY</field><value name=\"VALUE\"><block type=\"math_number\" id=\"2ldm,Z91u[eNpL{LlNm=\"><field name=\"NUM\">0</field></block></value><next><block type=\"controls_if\" id=\"gABLV#RT#,Fg%y9vusr_\"><mutation elseif=\"1\"></mutation><value name=\"IF0\"><block type=\"logic_operation\" id=\"ceg_$r-KuGE8*~FhrwyQ\"><field name=\"OP\">AND</field><value name=\"A\"><block type=\"logic_compare\" id=\"Qf*Ks/Tqx-Pn7SRtB(0U\"><field name=\"OP\">EQ</field><value name=\"A\"><block type=\"get_time\" id=\"jins93hF8SRk)Hb9J.dq\"><field name=\"get_time\">4</field></block></value><value name=\"B\"><block type=\"text\" id=\"*=JD]JK)tq4p.RFip/Z]\"><field name=\"TEXT\">23</field></block></value></block></value><value name=\"B\"><block type=\"logic_compare\" id=\"1|yr)5/~XA|gdwo-RTkN\"><field name=\"OP\">EQ</field><value name=\"A\"><block type=\"get_time\" id=\"_Hw3c)98A^PI0zk[G!@:\"><field name=\"get_time\">5</field></block></value><value name=\"B\"><block type=\"text\" id=\"^WS2d_zDxqW|%8c!_=j@\"><field name=\"TEXT\">21</field></block></value></block></value></block></value><statement name=\"DO0\"><block type=\"yolobit_pin_write_digital\" id=\"~]r~9iUC,hGZX7Di_5=l\"><field name=\"pin\">3</field><value name=\"output\"><shadow type=\"math_number\" id=\"38JAtMBIYW}_?R6mV53h\"><field name=\"NUM\">0</field></shadow><block type=\"yolobit_pin_onoff_value\" id=\"GdV3[cP6vr5NSaNA/ox(\"><field name=\"value\">1</field></block></value><next><block type=\"yolobit_mqtt_publish\" id=\"WDX4zRt25$6?L}UjfKF6\"><value name=\"MESSAGE\"><shadow type=\"text\" id=\"OA$w/2UCJS=t8-,+6+S3\"><field name=\"TEXT\">1</field></shadow></value><value name=\"TOPIC\"><shadow type=\"text\" id=\"M:+4RVNL,,|dV-5IQmwZ\"><field name=\"TEXT\">relay</field></shadow></value><next><block type=\"yolobit_basic_sleep\" id=\"W7-hZxhH-}Ek^S%=|jMv\"><value name=\"duration\"><shadow type=\"math_number\" id=\"Tp9t%ilmYlUWv?Gbbkfa\"><field name=\"NUM\">20000</field></shadow></value></block></next></block></next></block></statement><value name=\"IF1\"><block type=\"logic_operation\" id=\"?sz~ZQFJoE!VjD$lf]N(\"><field name=\"OP\">AND</field><value name=\"A\"><block type=\"logic_compare\" id=\"a4V*5{i?pFB}-_s)3IFE\"><field name=\"OP\">EQ</field><value name=\"A\"><block type=\"get_time\" id=\"dnJw(EQA$6=9.b(,{mk2\"><field name=\"get_time\">4</field></block></value><value name=\"B\"><block type=\"text\" id=\"=(83vMcdKOGMk}#;@JLu\"><field name=\"TEXT\">23</field></block></value></block></value><value name=\"B\"><block type=\"logic_compare\" id=\"A}[?]fk4;or2l9{#2QLX\"><field name=\"OP\">EQ</field><value name=\"A\"><block type=\"get_time\" id=\"KLAf/nN6_FzX+b{oezg?\"><field name=\"get_time\">5</field></block></value><value name=\"B\"><block type=\"text\" id=\"oR{;v|qHu#QvB]7IC;Nv\"><field name=\"TEXT\">24</field></block></value></block></value></block></value><statement name=\"DO1\"><block type=\"yolobit_pin_write_digital\" id=\"C-~B)h{^5nXg{Fm@j(r5\"><field name=\"pin\">3</field><value name=\"output\"><shadow type=\"math_number\" id=\"38JAtMBIYW}_?R6mV53h\"><field name=\"NUM\">0</field></shadow><block type=\"yolobit_pin_onoff_value\" id=\"Kc/e@tT.Fm4#`Zx}t552\"><field name=\"value\">0</field></block></value><next><block type=\"yolobit_mqtt_publish\" id=\"PouT3-Oovhd7j{C?8@l.\"><value name=\"MESSAGE\"><shadow type=\"text\" id=\"kc37W!N_J%6RNo1dBN9b\"><field name=\"TEXT\">0</field></shadow></value><value name=\"TOPIC\"><shadow type=\"text\" id=\".T3^xzfZ1YsTDb07SRL-\"><field name=\"TEXT\">relay</field></shadow></value></block></next></block></statement></block></next></block></statement></block></xml>","python":"from machine import Pin, SoftI2C\nfrom aiot_dht20 import DHT20\nfrom aiot_lcd1602 import LCD1602\nfrom mqtt import *\nfrom machine import RTC\nimport ntptime\nimport time\nfrom yolobit import *\nbutton_a.on_pressed = None\nbutton_b.on_pressed = None\nbutton_a.on_pressed_ab = button_b.on_pressed_ab = -1\nfrom aiot_rgbled import RGBLed\n\naiot_dht20 = DHT20()\n\naiot_lcd1602 = LCD1602()\n\n# Mô tả hàm này...\ndef DHT20():\n  global Cycle_DHT20, CL_RELAY, th_C3_B4ng_tin, aiot_dht20, aiot_lcd1602, tiny_rgb\n  Cycle_DHT20 = (Cycle_DHT20 if isinstance(Cycle_DHT20, (int, float)) else 0) + 1\n  if Cycle_DHT20 >= 5:\n    Cycle_DHT20 = 0\n    aiot_dht20.read_dht20()\n    aiot_lcd1602.move_to(0, 0)\n    aiot_lcd1602.putstr(('TEMP : ' + str(aiot_dht20.dht20_temperature())))\n    aiot_lcd1602.move_to(0, 0)\n    aiot_lcd1602.putstr(('HUMA: ' + str(aiot_dht20.dht20_humidity())))\n    mqtt.publish('bbc-temp', (aiot_dht20.dht20_temperature()))\n    mqtt.publish('huma', (aiot_dht20.dht20_humidity()))\n\ntiny_rgb = RGBLed(pin14.pin, 4)\n\ndef on_mqtt_message_receive_callback__bbc_led_(th_C3_B4ng_tin):\n  global Cycle_DHT20, CL_RELAY, http_response\n  if th_C3_B4ng_tin == '1':\n    tiny_rgb.show(0, hex_to_rgb('#ff0000'))\n  else:\n    tiny_rgb.show(0, hex_to_rgb('#000000'))\n\ndef on_mqtt_message_receive_callback__bbc_quat_(th_C3_B4ng_tin):\n  global Cycle_DHT20, CL_RELAY, http_response\n  pin10.write_analog(round(translate((int(th_C3_B4ng_tin)), 0, 100, 0, 1023)))\n\n# Mô tả hàm này...\ndef on_time():\n  global Cycle_DHT20, CL_RELAY, th_C3_B4ng_tin, aiot_dht20, aiot_lcd1602, tiny_rgb\n  CL_RELAY = 0\n  if ('%0*d' % (2, RTC().datetime()[4])) == '23' and ('%0*d' % (2, RTC().datetime()[5])) == '21':\n    pin3.write_digital((1))\n    mqtt.publish('relay', '1')\n    time.sleep_ms(20000)\n  elif ('%0*d' % (2, RTC().datetime()[4])) == '23' and ('%0*d' % (2, RTC().datetime()[5])) == '24':\n    pin3.write_digital((0))\n    mqtt.publish('relay', '0')\n\nif True:\n  mqtt.connect_wifi('Tho1', 'thobec113')\n  Cycle_DHT20 = 0\n  CL_RELAY = 0\n  ntptime.settime()\n  (year, month, mday, week_of_year, hour, minute, second, milisecond) = RTC().datetime()\n  RTC().init((year, month, mday, week_of_year, hour+7, minute, second, milisecond))\n  mqtt.connect_broker(server='io.adafruit.com', port=1883, username='ThuyXiba', password='aio_trkG309x5yjE2jyhWP7UR53tYAqI')\n  display.show(Image.HEART)\n  mqtt.on_receive_message('bbc-led', on_mqtt_message_receive_callback__bbc_led_)\n  mqtt.on_receive_message('bbc-led', on_mqtt_message_receive_callback__bbc_led_)\n  mqtt.on_receive_message('bbc-quat', on_mqtt_message_receive_callback__bbc_quat_)\n\nwhile True:\n  mqtt.check_message()\n  DHT20()\n  on_time()\n  time.sleep_ms(1000)\n  time.sleep_ms(10)\n","name":"thuy","extensions":[{"id":"yolobit-AITT-VN-yolobit_extension_aiot","src":"https://github.com/AITT-VN/yolobit_extension_aiot","name":"AIOT Kit","description":"Mục mở rộng dành cho bộ kit AIoT"},{"id":"yolobit-AITT-VN-yolobit_extension_mqtt","src":"https://github.com/AITT-VN/yolobit_extension_mqtt","name":"MQTT","description":"Mục mở rộng hỗ trợ giao tiếp MQTT cho ứng dụng IoT"},{"id":"yolobit-AITT-VN-yolobit_ntp","src":"https://github.com/AITT-VN/yolobit_ntp","name":"NTP","description":"Mục mở rộng hỗ trợ đọc thời gian từ Internet qua giao thức NTP (Network Time Protocol)"}],"device":"yolobit"}